
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.3">
    
    
      
        <title>Pymagnet</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.1655a90d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pymagnet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Pymagnet" class="md-header__button md-logo" aria-label="Pymagnet">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pymagnet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Pymagnet" class="md-nav__button md-logo" aria-label="Pymagnet">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Pymagnet
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        Home
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-calculation-and-render-using-plotly" class="md-nav__link">
    3D calculation and render using plotly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2d-calculation-and-render-using-matplotlib" class="md-nav__link">
    2D calculation and render using matplotlib
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculating-magnetic-fields-and-forces" class="md-nav__link">
    Calculating Magnetic Fields and Forces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#licensing" class="md-nav__link">
    Licensing
  </a>
  
    <nav class="md-nav" aria-label="Licensing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contribution" class="md-nav__link">
    Contribution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="equations/" class="md-nav__link">
        Field Equations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="methods/" class="md-nav__link">
        Methods
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Code Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="pymagnet/" class="md-nav__link">
        pymagnet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="magnets/" class="md-nav__link">
        magnets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="plots/" class="md-nav__link">
        plots
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="quaternions/" class="md-nav__link">
        quaternions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-calculation-and-render-using-plotly" class="md-nav__link">
    3D calculation and render using plotly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2d-calculation-and-render-using-matplotlib" class="md-nav__link">
    2D calculation and render using matplotlib
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculating-magnetic-fields-and-forces" class="md-nav__link">
    Calculating Magnetic Fields and Forces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#licensing" class="md-nav__link">
    Licensing
  </a>
  
    <nav class="md-nav" aria-label="Licensing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contribution" class="md-nav__link">
    Contribution
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="pymagnet">Pymagnet</h1>
<p>User friendly magnetic field calculations in Python</p>
<p><a href="https://opensource.org/licenses/MPL-2.0"><img alt="License: MPL 2.0" src="https://img.shields.io/badge/License-MPL%202.0-blue.svg" /></a>
<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="License: CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--SA%204.0-lightgrey.svg" /></a></p>
<h2 id="getting-started">Getting Started</h2>
<p>Installing <code>pymagnet</code> can be done using</p>
<div class="highlight"><pre><span></span><code>python -m pip install pymagnet 
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code>conda install -c pdunne pymagnet
</code></pre></div>
<h3 id="examples">Examples</h3>
<p>Additional examples are in the <a href="https://github.com/pdunne/pymagnet/tree/main/examples">examples directory of the repository</a>.</p>
<h3 id="3d-calculation-and-render-using-plotly">3D calculation and render using plotly</h3>
<p>A cylinder of radius 5 mm, length 20 mm, is instantiated and rotated by 30 degrees about the x-axis
by 330 degrees. Two example plots are shown, using surface slices along the three principal axes,
and a volume plot.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pymagnet</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="n">pm</span><span class="o">.</span><span class="n">reset_magnets</span><span class="p">()</span> <span class="c1"># clear magnet registry</span>

<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    
<span class="n">radius</span> <span class="o">=</span> <span class="mf">5e-3</span>    
<span class="n">length</span> <span class="o">=</span> <span class="mf">20e-3</span>

<span class="c1"># Create a magnet instance</span>
<span class="n">m_cyl</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">magnets</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">length</span><span class="p">,</span> <span class="n">Jr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
                            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># rotation of magnet w.r.t. z-axis</span>
                            <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="c1"># rotation of magnet w.r.t. y-axis</span>
                            <span class="n">gamma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># rotation of magnet w.r.t. x-axis</span>
                            <span class="p">)</span>

<span class="c1"># Calculate and display 3 slices</span>
<span class="c1"># Cache is a dictionary containing all the calculated values</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">surface_slice3</span><span class="p">(</span><span class="n">cmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="c1"># minimum field value</span>
                                <span class="n">cmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="c1"># maximum field value</span>
                                <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="c1"># opacity of slices</span>
                                <span class="n">num_arrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># number of arrows in vector field</span>
                                <span class="n">cone_opacity</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="c1"># opacity of arrows</span>
                                <span class="p">)</span>


<span class="c1"># Calculate and display volume plot</span>
<span class="c1"># volume_cache is a dictionary containing all the calculated values</span>
<span class="n">volume_cache</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">volume_plot</span><span class="p">(</span><span class="n">cmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="c1"># minimum field value</span>
                                    <span class="n">cmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="c1"># maximum field value</span>
                                    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="c1"># needs to be small for visibility</span>
                                    <span class="n">num_levels</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="c1"># number of color levels to be plotted</span>
                                    <span class="c1"># number of points in each direction, total number is num_points^3</span>
                                    <span class="n">num_points</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                    <span class="p">)</span>
</code></pre></div>
<figure>
  <img src="img/3d_example_slice_1.png" width=400/>
  <img src="img/3d_example_slice_2.png" width=400/>
  <figcaption>3D surface slice plot</figcaption>
</figure>

<figure>
  <img src="img/3d_example_volume_1.png" width=400/>
  <img src="img/3d_example_volume_2.png" width=400/>
  <figcaption>3D volume plot</figcaption>
</figure>

<h3 id="2d-calculation-and-render-using-matplotlib">2D calculation and render using matplotlib</h3>
<figure>
  <img src="img/2d_circle_contour.png" width=400/>
  <img src="img/2d_circle_stream.png" width=400/>
  <figcaption>2D contour plot and streamplot of a long bipolar rod</figcaption>
</figure>

<p>Two square magnets of 20x20 mm are added, and a contour plot with a vector field are drawn.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pymagnet</span> <span class="k">as</span> <span class="nn">pm</span>

<span class="n">pm</span><span class="o">.</span><span class="n">reset_magnets</span><span class="p">()</span> <span class="c1"># clear magnet registry</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span> <span class="c1"># set the colormap</span>

<span class="n">radius</span> <span class="o">=</span> <span class="mf">10e-3</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create magnet</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">magnets</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">Jr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>


<span class="c1"># Prepare 100x100 grid of x,y coordinates to calculate the field</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">grid2D</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">radius</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">radius</span><span class="p">)</span>

<span class="c1"># Calculate the magnetic field due to all magnets in the registry</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">B_calc_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Plot the result, vector_plot = True toggles on the vector field plot</span>
<span class="n">pm</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_2D_contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span>
                         <span class="n">cmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                         <span class="n">num_levels</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                         <span class="n">vector_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">vector_arrows</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>



<span class="c1"># Plot the result as a streamplot </span>
<span class="n">pm</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_2D_contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span>
                         <span class="n">cmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>
                         <span class="n">cmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                         <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;streamplot&quot;</span><span class="p">,</span>
                         <span class="n">stream_color</span><span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="c1"># &#39;vertical&#39;, &#39;horizontal&#39;, &#39;normal&#39;:</span>
                        <span class="c1">#  corresponds to coloring by B.x, B.y, B.n</span>
                        <span class="p">)</span>
</code></pre></div>
<figure>
  <img src="img/2d_example.png" width=400/>
  <figcaption>2D contour plot</figcaption>
</figure>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pymagnet</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="n">pm</span><span class="o">.</span><span class="n">reset_magnets</span><span class="p">()</span> <span class="c1"># clear magnet registry</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span> <span class="c1"># set the colormap</span>

<span class="n">width</span> <span class="o">=</span> <span class="mf">20e-3</span>
<span class="n">height</span> <span class="o">=</span> <span class="mf">20e-3</span>

<span class="c1"># Set the space between magnets to be the width of one</span>
<span class="n">half_gap</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> 

<span class="c1"># Center of first magnet</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">half_gap</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create first magnet</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">magnets</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
                        <span class="n">Jr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Centre of second magnet</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">half_gap</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create second magnet</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">magnets</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
                        <span class="n">Jr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">)</span>

<span class="c1"># Prepare 100x100 grid of x,y coordinates to calculate the field</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">grid2D</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># Calculate the magnetic field due to all magnets in the registry</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">B_calc_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Plot the result, vector_plot = True toggles on the vector field plot</span>
<span class="n">pm</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_2D_contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">cmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="c1"># minimum field value</span>
                                 <span class="n">cmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="c1"># maximum field value</span>
                                 <span class="n">vector_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># plot the vector field</span>
                                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="c1"># set the colormap</span>
                                 <span class="p">)</span>
</code></pre></div>
<h2 id="calculating-magnetic-fields-and-forces">Calculating Magnetic Fields and Forces</h2>
<p>Forms of this library have been used in a number of projects including <a href="https://www.nature.com/articles/s41586-020-2254-4">Liquid flow and control without solid walls, Nature 2020</a>.</p>
<h2 id="features">Features</h2>
<p>This code uses analytical expressions to calculate the magnetic field due to
simple magnets. These include:</p>
<ul>
<li>3D objects: cubes, cuboids, cylinders, spheres</li>
<li>2D: rectangles, squares</li>
</ul>
<p>There are helper functions to plot the data as either line or countour plots,
but the underlying data is also accessible.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Ensure you have <a href="https://www.anaconda.com/">Python</a> version &gt;= 3.6
 (to use f-strings), and the following packages:</p>
<ul>
<li>numpy</li>
<li>matplotlib</li>
<li>numba</li>
<li>plotly</li>
</ul>
<div class="admonition todo">
<p class="admonition-title">Todo</p>
<ul>
<li>Calculation of magnetisation and the H field inside the magnets</li>
<li>Complete documentation</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul>
<li>For spheres, rotate them using alpha, beta, gamma,
rather than the magnetisation angles theta and phi, as phi rotations are not working correctly.</li>
<li>Similarly, for circles, rotate them using alpha, not phi.</li>
</ul>
</div>
<h2 id="licensing">Licensing</h2>
<p>Source code licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License Version 2.0</a></p>
<p>Documentation is licensed under a Creative Commons Attribution-ShareAlike 4.0 International <a href="https://creativecommons.org/licenses/by-sa/4.0/">(CC BY-SA 4.0)</a> license.</p>
<p>This is a human-readable summary of (and not a substitute for) the license, adapted from <a href="https://cs50.harvard.edu/x/2021/license/">CS50x</a>. Official translations of this license are available in other languages.</p>
<p><strong>You are free to:</strong></p>
<ul>
<li><strong>Share</strong> — copy and redistribute the material in any medium or format.</li>
<li><strong>Adapt</strong> — remix, transform, and build upon the material.</li>
</ul>
<p><strong>Under the following terms:</strong></p>
<ul>
<li><strong>Attribution</strong> — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.</li>
<li><strong>ShareAlike</strong> — If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original</li>
<li>No additional restrictions — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.</li>
</ul>
<h3 id="contribution">Contribution</h3>
<p>Unless you explicitly state otherwise, any contribution intentionally submitted
for inclusion in the work by you shall be licensed as above, without any
additional terms or conditions.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
      
        <a href="equations/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Field Equations
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.ca5457b8.min.js"></script>
      
        <script src="javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>