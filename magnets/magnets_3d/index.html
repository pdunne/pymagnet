
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.3.0, mkdocs-material-8.2.14" name="generator"/>
<title>3D Magnets - Pymagnet</title>
<link href="../../assets/stylesheets/main.3de6f41f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.cc9b2e1e.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#3d-magnets">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Pymagnet" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Pymagnet">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Pymagnet
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              3D Magnets
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Pymagnet" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Pymagnet">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Pymagnet
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/">
        Examples
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Magnets
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Magnets" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Magnets
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../magnets_overview/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../magnets_1d/">
        1D Methods
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../magnets_2d/">
        2D Magnets
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          3D Magnets
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        3D Magnets
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#prismscuboids">
    Prisms/Cuboids
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cylinderssolenoids">
    Cylinders/Solenoids
  </a>
<nav aria-label="Cylinders/Solenoids" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bulirschs-complete-elliptic-integral">
    Bulirsch's complete elliptic integral
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#spheres">
    Spheres
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../composite_magnets/">
        Composite Magnets
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Plots
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Plots" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Plots
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../plots/plots_overview/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../plots/plots_2d/">
        2D Plots
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../plots/plots_3d/">
        3D Plots
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../forces_torques/">
        Forces &amp; Torques
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          Methods
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Methods" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Methods
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../methods/methods/">
        Class Methods
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../methods/transforms/">
        Transforms
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Code Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../code_reference/pymagnet/">
        pymagnet
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../code_reference/magnets/">
        magnets
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../code_reference/plots/">
        plots
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../code_reference/utils/">
        utils
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#prismscuboids">
    Prisms/Cuboids
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cylinderssolenoids">
    Cylinders/Solenoids
  </a>
<nav aria-label="Cylinders/Solenoids" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bulirschs-complete-elliptic-integral">
    Bulirsch's complete elliptic integral
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
    Example
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#spheres">
    Spheres
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="3d-magnets">3D Magnets</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>SI Units with the Sommerfeld convetion are used for this discussion:
<span class="arithmatex">\(\mathbf{B} = \mu_0 \left( \mathbf{H} + \mathbf{M}  \right)\)</span><sup id="fnref3:1"><a class="footnote-ref" href="#fn:1">1</a></sup></li>
<li>However, the Kennelly Convetion is used for the creation of each magnet object
in the library:
<span class="arithmatex">\(\mathbf{B} = \mu_0\mathbf{H} + \mathbf{J}\)</span><sup id="fnref4:1"><a class="footnote-ref" href="#fn:1">1</a></sup></li>
<li>In free space <span class="arithmatex">\(\mathbf{B} = \mu_0 \mathbf{H}\)</span></li>
<li>In magnetised bodies, the demagnetising field <span class="arithmatex">\(\mathbf{H_d} = - N \mathbf{M}\)</span>,
where <span class="arithmatex">\(N\)</span> is the demagnetising factor.</li>
</ul>
</div>
<p>The derived equations for 3D magnets were performed using the Coulombic Charge model
rather than the Amperian current model of the 2D systems. More correctly they are
derived in terms of the <span class="arithmatex">\(H\)</span> field rather than <span class="arithmatex">\(B\)</span>, but which in free space only differ
by a factor <span class="arithmatex">\(\mu_0\)</span>, i.e. <span class="arithmatex">\(\mathbf{B} = \mu_0 \mathbf{H}\)</span>.</p>
<p>In the Kennelly convention of electromagnetic units every factor <span class="arithmatex">\(\mu_0 M_r\)</span> can be
replaced by <span class="arithmatex">\(J\)</span> or <span class="arithmatex">\(J_r\)</span>.</p>
<h2 id="prismscuboids">Prisms/Cuboids</h2>
<figure>
<img src="../../img/3d_prism.png" width="300"/>
</figure>
<p>For a uniformly magnetised cuboid, used in our experiments, with dimensions <span class="arithmatex">\(2a
\times  2b \times 2c\)</span> magnetised in the <span class="arithmatex">\(x\)</span>-direction
is<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup></p>
<div class="arithmatex">\[
\begin{align}
B_x = &amp;-\frac{\mu_0 M_r}{4\pi} \Big[ F_1\left(-x,y,z\right)
+ F_1\left(-x,y,-z \right) \nonumber\\
 &amp; + F_1\left(-x,-y,z \right) + F_1\left(-x,-y,-z\right) + F_1\left(x,y,z\right) \nonumber\\
 &amp; + F_1\left(x,y,-z \right) + F_1\left(x,-y,z\right) + F_1\left(x,-y,-z\right) \Big]
 \end{align}
\]</div>
<div class="arithmatex">\[
B_y = \frac{\mu_0 M_r}{4\pi}
\ln{\left[\frac{F_2\left(-x,-y,-z\right)F_2\left(x,y,z\right)}{F_2\left(x,y,-z\right)F_2\left(-x,y,z\right)}\right]}
\]</div>
<div class="arithmatex">\[
B_z = \frac{\mu_0 M_r}{4\pi}
\ln{\left[
    \frac{F_2\left(-x,-z,y\right)F_2\left(x,z,y\right)}{F_2\left(-x,z,y\right)F_2\left(x,-z,y\right)}
    \right]}
\]</div>
<p>where the functions <span class="arithmatex">\(F_1\)</span> and <span class="arithmatex">\(F_2\)</span> are</p>
<div class="arithmatex">\[
F_1\left(x,y,z\right) = \tan^{-1}{\frac{\left(b+y\right)\left(c+z\right)}
{\left(a+x\right)\sqrt{\left(a+x\right)^2+\left(b+y\right)^2+\left(c+z\right)^2}}}
\]</div>
<div class="arithmatex">\[
F_2\left(x,y,z\right) = \frac{\sqrt{\left(a+x\right)^2+\left(b+y\right)^2+\left(c-z\right)^2}+c-z}
{\sqrt{\left(a+x\right)^2+\left(b+y\right)^2+\left(c+z\right)^2}-c-z}
\]</div>
<p>For a bar magnetised in <span class="arithmatex">\(z\)</span>, the above equations can be rewritten by a 90˚
rotation about <span class="arithmatex">\(y\)</span>, leading to<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup></p>
<div class="arithmatex">\[
B_x = \frac{\mu_0 M_r}{4\pi}\ln{\left[
\frac{F_2\left(-x,y,-z\right)F_2\left(x,y,z\right)}
{F_2\left(x,y,-z\right)F_2\left(-x,y,z\right)}
\right]}
\]</div>
<div class="arithmatex">\[
B_y = \frac{\mu_0M_r}{4\pi}\ln{\left[
\frac{F_2\left(-y,x,-z\right)F_2\left(y,x,z\right)}
{F_2\left(y,x,-z\right)F_2\left(-y,x,z\right)}
\right]}
\]</div>
<div class="arithmatex">\[
\begin{align}
B_z = &amp;-\frac{\mu_0 M_r}{4\pi} \Big[ F_1\left(-x,y,z\right)
+ F_1\left(-x,y,-z \right) \nonumber\\
 &amp; + F_1\left(-x,-y,z \right) + F_1\left(-x,-y,-z\right) + F_1\left(x,y,z\right) \nonumber\\
 &amp; + F_1\left(x,y,-z \right) + F_1\left(x,-y,z\right) + F_1\left(x,-y,-z\right) \Big]
\end{align}
\]</div>
<p>where the functions <span class="arithmatex">\(F_1\)</span> and <span class="arithmatex">\(F_2\)</span> are</p>
<div class="arithmatex">\[
F_1\left(x,y,z\right)= \tan^{-1}
\frac{\left(a+x\right)\left(b+y\right)}{\left(c+z\right)
\sqrt{\left(a+x\right)^2+\left(b+y\right)^2+\left(c+z\right)^2}}
\]</div>
<div class="arithmatex">\[
F_2\left(x,y,z\right)=\frac{\sqrt{\left(a+x\right)^2+\left(b-y\right)^2+\left(c+z\right)^2}+b-y}
{\sqrt{\left(a+x\right)^2+\left(b+y\right)^2+\left(c+z\right)^2}-b-y}
\]</div>
<p>Similar equations can be attained for a magnet magnetised in <span class="arithmatex">\(y\)</span> by a 90˚ rotation
of the first set of equations about the <span class="arithmatex">\(z\)</span>-axis.</p>
<h2 id="cylinderssolenoids">Cylinders/Solenoids</h2>
<figure>
<img src="../../img/3d_cylinder.png" width="300"/>
</figure>
<p>Recalling that the magnetic field due to a cylinder of length <span class="arithmatex">\(2b\)</span> and radius <span class="arithmatex">\(a\)</span>,
with a current <span class="arithmatex">\(I\)</span> running through <span class="arithmatex">\(n\)</span> turns of wire along the symmetry axis is:</p>
<div class="arithmatex">\[
B_z = \frac{\mu_0 n I}{2} \left[
\frac{z + b}{\sqrt{ (z + b)^2 - a^2 }} -
\frac{z - b}{\sqrt{ (z - b)^2 - a^2 }}  \right]
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This is equivalent to the equation in the <a href="#cylinder">Cylinder section</a>,
where <span class="arithmatex">\(\mu_0 n I \equiv \mu_0 M_r\)</span></li>
<li>For an infinite solenoid, this reduces to <span class="arithmatex">\(B_z = \mu_0 n I\)</span> at its center</li>
</ul>
</div>
<p>For the general case, including off-axis points the field in cylindrical coordinates
becomes</p>
<div class="arithmatex">\[
B_\rho = B_0 \left[ \alpha_+ C(k_+, 1, 1, -1)
- \alpha_- C(k_-, 1, 1, -1)
\right]
\]</div>
<p>and</p>
<div class="arithmatex">\[
B_z = \frac{B_0 a}{a + \rho} \left[
\beta_+ C(k_+, \gamma^2, 1, \gamma)
- \beta_- C(k_, \gamma^2, 1, \gamma)
\right]
\]</div>
<p>where:</p>
<div class="arithmatex">\[
B_0 = \frac{\mu_0}{\pi}n I \,\,\,\,\, z_\pm = z \pm b
\]</div>
<div class="arithmatex">\[
\alpha_\pm = \frac{a}{\sqrt{z^2_\pm + (\rho + a)^2 }} \,\,\,\,\,\, \beta_\pm = \frac{z_\pm}{\sqrt{z^2_\pm + (\rho + a)^2 }}
\]</div>
<div class="arithmatex">\[
\gamma = \frac{a - \rho}{a + \rho} \,\,\,\,\,\,\, k_\pm = \sqrt{ \frac{z^2_\pm + (a - \rho)^2}{z^2_\pm + (a + \rho)^2} }
\]</div>
<p>and <span class="arithmatex">\(C\)</span> is Bulirsch's 'cel' function<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>.</p>
<h3 id="bulirschs-complete-elliptic-integral">Bulirsch's complete elliptic integral</h3>
<p>See NIST Handbook of Mathematical Functions<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup></p>
<div class="arithmatex">\[
C\left(k_c, p, c,s \right) = \int_0 ^{\pi/2} \frac{ \left( c \cos^2 \varphi + s \sin^s \varphi  \right) d\varphi }
{\left( \cos^2 \varphi + p \sin^2 \varphi \right) \sqrt{ \cos^2 \varphi + k_c^2 \sin^2 \varphi  } }
\]</div>
<p>The three standard Legendre forms of the complete elliptic integrals
can be written using the generalised complete elliptic integral of
Bulirsch:</p>
<p><span class="arithmatex">\(K(k) = C(k_c, 1, 1, 1)\)</span></p>
<p><span class="arithmatex">\(E(K) = C(k_c, 1, 1, k_c^2)\)</span></p>
<p><span class="arithmatex">\(\Pi(n, k) = C(k_c, n+1, 1, 1)\)</span></p>
<p>A simple algorirthm for solving the elliptic integrals<sup id="fnref2:6"><a class="footnote-ref" href="#fn:6">6</a></sup> is included as a <code>@staticmethod</code>
in the <code>Cylinder</code> subclass. It is vectorised and JIT compiled as a Numpy ufunc using
Numba for improved performance:</p>
<pre><code>Cylinder._cel(kc, p, c, s)
</code></pre>
<h3 id="example">Example</h3>
<p>Here is an example of how to use it, for the special case of
<span class="arithmatex">\(k_c = 1\)</span> for the first complete elliptic integral, <span class="arithmatex">\(K(1)\)</span>:</p>
<p><span class="arithmatex">\(C\left(1, 1, 1, 1 \right)  = \pi/2\)</span></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pymagnet</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">cel_value</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">magnets</span><span class="o">.</span><span class="n">Cylinder</span><span class="o">.</span><span class="n">_cel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">cel_value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span>
</code></pre></div>
<h2 id="spheres">Spheres</h2>
<figure>
<img src="../../img/3d_sphere.png" width="300"/>
</figure>
<p>Outside a uniformly magnetised sphere<sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup> of radius <span class="arithmatex">\(a\)</span>, the stray field is identical to a magnetic
dipole, and has a convenient representation in spherical coordinates:</p>
<div class="arithmatex">\[
\mathbf{B} = \frac{\mu_0 M_r}{3} \left( \frac{a^3}{r^3}\right) \left[
    2\cos(\theta) \mathbf{\hat{r}} + \sin(\theta) \mathbf{\hat{\theta}}
     \right]
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>SI Units with the Sommerfeld convetion are used for this discussion:
<span class="arithmatex">\(\mathbf{B} = \mu_0 \left( \mathbf{H} + \mathbf{M}  \right)\)</span><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></li>
<li>However, the Kennelly Convetion is used for the creation of each magnet object
in the library:
<span class="arithmatex">\(\mathbf{B} = \mu_0\mathbf{H} + \mathbf{J}\)</span><sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup></li>
<li>In free space <span class="arithmatex">\(\mathbf{B} = \mu_0 \mathbf{H}\)</span></li>
<li>In magnetised bodies, the demagnetising field <span class="arithmatex">\(\mathbf{H_d} = - N \mathbf{M}\)</span>,
where <span class="arithmatex">\(N\)</span> is the demagnetising factor.</li>
</ul>
</div>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>J. M. D. Coey, Magnetism and Magnetic Materials (Cambridge University Press, 2010). <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref3:1" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref4:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>E. P. Furlani, Permanent Magnet and Electromechanical Devices (Academic Press, San Diego, 2001). <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p>Z. J. Yang, T. H. Johansen, H. Bratsberg, G. Helgesen, and A. T. Skjeltorp, Potential and Force between a Magnet and a Bulk Y1Ba2Cu3O7-δ Superconductor Studied by a Mechanical Pendulum, Superconductor Science and Technology 3, 591 (1990). <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:4">
<p>J. M. Camacho and V. Sosa, Alternative Method to Calculate the Magnetic Field of Permanent Magnets with Azimuthal Symmetry, Revista Mexicana de Física E 59, 8 (2013). <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:5">
<p>R. Bulirsch, Numerical Calculation of Elliptic Integrals and Elliptic Functions. III, Numer. Math. 13, 305 (1969). <a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
<li id="fn:6">
<p>See <a href="http://dlmf.nist.gov/19.2">http://dlmf.nist.gov/19.2</a> <a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">↩</a><a class="footnote-backref" href="#fnref2:6" title="Jump back to footnote 6 in the text">↩</a></p>
</li>
<li id="fn:7">
<p>N. Derby and S. Olbert, Cylindrical Magnets and Ideal Solenoids, American Journal of Physics 78, 229 (2010). <a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">↩</a></p>
</li>
<li id="fn:8">
<p>Adapted from <a href="https://commons.wikimedia.org/wiki/File:Kugelkoord-lokale-Basis-s.svg">here</a> <a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: 2D Magnets" class="md-footer__link md-footer__link--prev" href="../magnets_2d/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              2D Magnets
            </div>
</div>
</a>
<a aria-label="Next: Composite Magnets" class="md-footer__link md-footer__link--next" href="../composite_magnets/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Composite Magnets
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.c2e1ee47.min.js"></script>
<script src="../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>